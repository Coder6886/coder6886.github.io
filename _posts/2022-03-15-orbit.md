---
layout:     post
title:      行星轨迹解析解
subtitle:   
date:       2022-03-15
author:     coder6886
header-img: img/post-bg-ios9-web.jpg
catalog: true
usemathjax: true
tags:
    - python 
---
这个程序可以画出行星的轨道

代码：
```python
import numpy as np
import mpl_toolkits.axisartist as axisartist
import matplotlib.pyplot as plt
G=6.67e-11

M=1e10
x0=2
y0=0.1
v0=1.1

def proot(a1,b1,c1):
    return (-b1+(b1**2-4*a1*c1)**0.5)/2/a1
def mroot(a1,b1,c1):
    return (-b1-(b1**2-4*a1*c1)**0.5)/2/a1
a=1/(v0**2/G/M-2/(x0**2+y0**2)**0.5)
c=(x0-((2*a-(x0**2+y0**2)**0.5)**2-y0**2)**0.5)/2
b=(a**2-c**2)**0.5
fig = plt.figure()
ax = axisartist.Subplot(fig,111)
fig.add_axes(ax)
ax.axis[:].set_visible(False)
ax.axis["x"] = ax.new_floating_axis(0,0)
ax.axis["x"].set_axisline_style("-|>", size = 1.0)
ax.axis["y"] = ax.new_floating_axis(1,0)
ax.axis["y"].set_axisline_style("-|>", size = 1.0)
ax.axis["x"].set_axis_direction("top")
ax.axis["y"].set_axis_direction("right")
ang = np.linspace(0,2*np.pi,200)
x=a*np.sin(ang)+c
y=b*np.cos(ang)
p1,p2=(x0,y0)
theta = np.arctan(p2/p1)
if p1 < 0:
    theta += np.pi
while True:
    if len(plt.get_fignums()) == 0:
        break;
    plt.cla()
    ax.axis[:].set_visible(False)
    ax.axis["x"] = ax.new_floating_axis(0,0)
    ax.axis["x"].set_axisline_style("-|>", size = 1.0)
    ax.axis["y"] = ax.new_floating_axis(1,0)
    ax.axis["y"].set_axisline_style("-|>", size = 1.0)
    ax.axis["x"].set_axis_direction("top")
    ax.axis["y"].set_axis_direction("right")
    plt.plot(x,y)
    plt.plot(0,0,'ro',markersize=25,label='sun')
    plt.plot(p1,p2,'bo',markersize=15,label='planet')
    theta+=np.arcsin(np.pi*a*b/100/(p1**2+p2**2))
    theta=theta%(np.pi*2)
    if theta > 0 and theta < np.pi/2 or theta > np.pi/2*3 and theta < np.pi*2:
        p1 = proot(b**2+a**2*np.tan(theta)**2,-2*b**2*c,b**2*c**2-a**2*b**2)
    else:
        p1 = mroot(b**2+a**2*np.tan(theta)**2,-2*b**2*c,b**2*c**2-a**2*b**2)
    p2=np.tan(theta)*p1
    plt.legend()
    plt.pause(0.0005)
plt.show()
```
大家可以试着改一下$M,x_0,y_0和v_0$。

如果发现程序出错了，那就是这一组数据无法使行星沿椭圆轨道运行。

**这里我们假设的是椭圆的长轴在$x$轴上**

原理的话就是可以根据[轨道速度公式](https://zh.wikipedia.org/wiki/%E8%BD%A8%E9%81%93%E9%80%9F%E5%BA%A6)和初始条件倒退出椭圆的半长轴、半短轴和半焦距。